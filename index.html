<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mango听书</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #FFA500;
            --primary-dark: #E69500;
            --primary-light: rgba(255, 165, 0, 0.1);
            --dark-bg: #121212;
            --dark-surface: #1e1e1e;
            --dark-surface-hover: #2a2a2a;
            --dark-surface-active: #333;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --divider: #333;
            --error: #cf6679;
            --success: #4caf50;
            --warning: #ff9800;
            --border-radius: 8px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        :root[data-theme="light"] {
            --primary: #FF8C00;
            --primary-dark: #E67E00;
            --primary-light: rgba(255, 140, 0, 0.1);
            --dark-bg: #f5f5f5;
            --dark-surface: #ffffff;
            --dark-surface-hover: #f0f0f0;
            --dark-surface-active: #e8e8e8;
            --text-primary: #333333;
            --text-secondary: #666666;
            --divider: #e0e0e0;
            --error: #d32f2f;
            --success: #388e3c;
            --warning: #f57c00;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            padding-bottom: 150px;
            -webkit-font-smoothing: antialiased;
            position: relative;
            min-height: 100vh;
            overflow-x: hidden;
        }

        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.5;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }
        
        header {
            background-color: var(--dark-surface);
            color: var(--text-primary);
            padding: 15px 0;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--divider);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        h1 {
            font-size: 1.5rem;
            font-weight: 500;
            letter-spacing: 1px;
            transition: var(--transition);
        }
        
        .search-box {
            display: flex;
            margin: 20px 0;
            position: relative;
            animation: fadeIn 0.5s ease;
        }
        
        .search-input {
            flex: 1;
            padding: 15px 20px;
            background-color: var(--dark-surface);
            color: var(--text-primary);
            border: 1px solid var(--divider);
            border-radius: var(--border-radius);
            font-size: 16px;
            outline: none;
            transition: var(--transition);
        }
        
        .search-input:focus {
            border-color: var(--primary);
        }
        
        .search-btn {
            position: absolute;
            right: 5px;
            top: 5px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: var(--transition);
        }
        
        .search-btn:hover {
            background-color: var(--primary-dark);
        }
        
        .tab-bar {
            display: flex;
            margin: 15px 0;
            border-radius: var(--border-radius);
            overflow: hidden;
            background-color: var(--dark-surface);
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }
        
        .tab-btn.active {
            color: var(--primary);
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 3px;
            background-color: var(--primary);
            border-radius: 3px 3px 0 0;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .book-list, .chapter-list, .shelf-list {
            margin-top: 15px;
            background-color: var(--dark-surface);
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid var(--divider);
        }
        
        .book-item, .chapter-item, .shelf-item {
            padding: 18px 20px;
            border-bottom: 1px solid var(--divider);
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .book-item:last-child, .chapter-item:last-child, .shelf-item:last-child {
            border-bottom: none;
        }
        
        .book-item:hover, .chapter-item:hover, .shelf-item:hover {
            background-color: var(--dark-surface-hover);
        }
        
        .book-cover {
            width: 70px;
            height: 90px;
            border-radius: 6px;
            object-fit: cover;
            margin-right: 20px;
            transition: transform 0.3s ease;
        }
        
        .book-item:hover .book-cover {
            transform: scale(1.03);
        }
        
        .book-info {
            flex: 1;
            overflow: hidden;
        }
        
        .book-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .book-author {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .book-intro {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .book-actions {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .book-action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 16px;
            transition: var(--transition);
            padding: 5px;
            border-radius: 50%;
        }
        
        .book-action-btn:hover {
            color: var(--primary);
            background-color: rgba(255,255,255,0.1);
        }
        
        .chapter-title {
            flex: 1;
            font-size: 15px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chapter-progress {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .chapter-actions {
            display: flex;
            gap: 10px;
        }
        
        .chapter-action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
            padding: 5px;
            border-radius: 50%;
        }
        
        .chapter-action-btn:hover {
            color: var(--primary);
            background-color: rgba(255,255,255,0.1);
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            color: var(--text-secondary);
        }
        
        .loading-spinner {
            border: 3px solid rgba(255, 165, 0, 0.2);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .back-btn {
            background: none;
            border: none;
            font-size: 18px;
            color: var(--text-primary);
            margin-right: 15px;
            cursor: pointer;
            transition: var(--transition);
            position: absolute;
            left: 15px;
        }
        
        .back-btn:hover {
            color: var(--primary);
        }
        
        .page-controls {
            display: flex;
            justify-content: center;
            margin-top: 25px;
        }
        
        .page-btn {
            padding: 10px 18px;
            margin: 0 8px;
            background-color: var(--dark-surface);
            color: var(--text-primary);
            border: 1px solid var(--divider);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }
        
        .page-btn:hover:not(:disabled) {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .page-btn:disabled {
            background-color: #333;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .current-page {
            padding: 10px 18px;
            margin: 0 8px;
            color: var(--text-primary);
        }
        
        .hidden {
            display: none;
        }
        
        .error-message {
            color: var(--error);
            text-align: center;
            padding: 20px;
            background-color: rgba(207, 102, 121, 0.1);
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid var(--error);
        }
        
        .success-message {
            color: var(--success);
            text-align: center;
            padding: 20px;
            background-color: rgba(76, 175, 80, 0.1);
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid var(--success);
        }
        
        .now-playing {
            background-color: var(--primary-light);
            border-left: 3px solid var(--primary);
        }
        
        .audio-player-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--dark-surface);
            padding: 15px 20px;
            z-index: 100;
            border-top: 1px solid var(--divider);
            transform: translateY(0);
            transition: transform 0.3s ease;
        }
        
        .audio-player-container.hidden {
            transform: translateY(100%);
        }
        
        .player-info {
            padding: 5px 0;
            font-size: 15px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .audio-player {
            width: 100%;
            height: 60px;
        }
        
        audio {
            width: 100%;
            background-color: var(--dark-surface);
        }
        
        audio::-webkit-media-controls-panel {
            background-color: var(--dark-surface);
        }
        
        audio::-webkit-media-controls-play-button,
        audio::-webkit-media-controls-current-time-display,
        audio::-webkit-media-controls-time-remaining-display,
        audio::-webkit-media-controls-timeline,
        audio::-webkit-media-controls-volume-slider {
            filter: invert(1);
        }
        
        .batch-download-panel {
            background-color: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid var(--divider);
        }
        
        .batch-download-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .batch-download-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .batch-download-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }
        
        .batch-download-btn:hover {
            background-color: var(--primary-dark);
        }
        
        .batch-download-btn:disabled {
            background-color: #333;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .batch-download-progress {
            margin-top: 10px;
            height: 5px;
            background-color: var(--divider);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .batch-download-progress-bar {
            height: 100%;
            background-color: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .batch-download-status {
            margin-top: 10px;
            font-size: 13px;
            color: var(--text-secondary);
            text-align: right;
        }
        
        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .player-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 18px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .player-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .player-btn:disabled {
            color: var(--text-secondary);
            cursor: not-allowed;
        }
        
        .player-btn.active {
            background-color: var(--primary);
            color: white;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }
        
        .empty-icon {
            font-size: 50px;
            margin-bottom: 15px;
            color: var(--text-secondary);
            opacity: 0.5;
        }
        
        .empty-text {
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .help-icon {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1000;
        }
        
        .help-modal {
            display: none;
            position: fixed;
            top: 60px;
            right: 20px;
            width: 300px;
            background-color: var(--dark-surface);
            border-radius: 5px;
            z-index: 1000;
            padding: 15px;
            border: 1px solid var(--divider);
        }
        
        .help-modal h3 {
            margin-top: 0;
            color: var(--primary);
        }
        
        .help-modal p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.3);
            z-index: 999;
        }
        
        .close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            cursor: pointer;
            z-index: 1000;
        }
        
        .particles-toggle {
            position: fixed;
            top: 60px;
            left: 20px;
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            cursor: pointer;
            z-index: 1000;
            font-size: 14px;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .search-input {
                padding: 12px 15px;
            }
            
            .book-item, .chapter-item, .shelf-item {
                padding: 15px;
            }
            
            .book-cover {
                width: 60px;
                height: 80px;
                margin-right: 15px;
            }
            
            .audio-player {
                height: 50px;
            }
            
            .player-controls {
                gap: 15px;
            }
            
            header {
                padding: 15px 40px;
            }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    
    <div class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon" id="themeIcon"></i>
    </div>
    
    <div class="particles-toggle" id="particlesToggle">
        <i class="fas fa-sparkles"></i>
    </div>
    
    <header>
        <button id="backBtn" class="back-btn hidden"><i class="fas fa-arrow-left"></i></button>
        <h1 id="pageTitle">Mango听书</h1>
        <button id="shelfBtn" class="back-btn hidden" style="left: auto; right: 15px;"><i class="fas fa-bookmark"></i></button>
    </header>
    
    <div class="container">
        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" placeholder="搜索书籍">
            <button id="searchBtn" class="search-btn"><i class="fas fa-search"></i> 搜索</button>
        </div>
        
        <div class="tab-bar">
            <button class="tab-btn active" id="searchTab"><i class="fas fa-search"></i> 搜索</button>
            <button class="tab-btn" id="shelfTab"><i class="fas fa-bookmark"></i> 书架</button>
            <button class="tab-btn" id="historyTab"><i class="fas fa-history"></i> 历史</button>
        </div>
        
        <div class="tab-content active" id="searchResults"></div>
        
        <div class="tab-content" id="shelfContent">
            <div id="shelfList" class="shelf-list">
                <div class="empty-state">
                    <div class="empty-icon"><i class="fas fa-book-open"></i></div>
                    <div class="empty-text">书架空空如也</div>
                    <button class="page-btn" id="exploreBooksBtn">去发现好书</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="historyContent">
            <div id="historyList" class="shelf-list">
                <div class="empty-state">
                    <div class="empty-icon"><i class="fas fa-clock"></i></div>
                    <div class="empty-text">暂无收听历史</div>
                </div>
            </div>
        </div>
        
        <div id="bookDetails" class="hidden">
            <h2 id="bookTitle"></h2>
            <div id="chapterList" class="chapter-list"></div>
            
            <div class="batch-download-panel hidden" id="batchDownloadPanel">
                <div class="batch-download-header">
                    <div class="batch-download-title"><i class="fas fa-download"></i> 批量下载</div>
                    <button class="batch-download-btn" id="batchDownloadBtn">下载选中章节</button>
                </div>
                <div class="batch-download-progress">
                    <div class="batch-download-progress-bar" id="downloadProgressBar"></div>
                </div>
                <div class="batch-download-status" id="downloadStatus">准备下载</div>
            </div>
        </div>
    </div>
    
    <div class="audio-player-container hidden" id="playerContainer">
        <div class="player-info" id="playerInfo">未播放</div>
        <audio controls id="audioPlayer" class="audio-player"></audio>
        <div class="player-controls">
            <button class="player-btn" id="prevBtn" title="上一章"><i class="fas fa-step-backward"></i></button>
            <button class="player-btn" id="nextBtn" title="下一章"><i class="fas fa-step-forward"></i></button>
            <button class="player-btn" id="shelfToggleBtn" title="加入书架"><i class="far fa-bookmark"></i></button>
        </div>
    </div>
    
    <div class="help-icon" id="helpIcon">?</div>
    
    <div class="help-modal" id="helpModal">
        <span class="close-btn" id="closeBtn">&times;</span>
        <h3>Mango听书使用说明</h3>
        <p>1. 搜索书籍并添加到书架</p>
        <p>2. 在书架中查看书籍目录</p>
        <p>3. 点击章节播放或下载</p>
    </div>
    
    <div class="overlay" id="overlay"></div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        const API_BASE = 'https://sdkapi.hhlqilongzhu.cn/api/fanqie_tingshu/';
        const API_KEY = 'Dragon53FA6A7389AB20A25A6CE425264A4B6A';
        
        let currentBook = null;
        let currentChapters = [];
        let currentPage = 1;
        let totalPages = 1;
        let currentAudioIndex = -1;
        let selectedChapters = new Set();
        let lastRequestTime = 0;
        const REQUEST_INTERVAL = 2000;
        
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const searchResults = document.getElementById('searchResults');
        const bookDetails = document.getElementById('bookDetails');
        const bookTitle = document.getElementById('bookTitle');
        const chapterList = document.getElementById('chapterList');
        const backBtn = document.getElementById('backBtn');
        const pageTitle = document.getElementById('pageTitle');
        const playerContainer = document.getElementById('playerContainer');
        const audioPlayer = document.getElementById('audioPlayer');
        const playerInfo = document.getElementById('playerInfo');
        const batchDownloadPanel = document.getElementById('batchDownloadPanel');
        const batchDownloadBtn = document.getElementById('batchDownloadBtn');
        const downloadProgressBar = document.getElementById('downloadProgressBar');
        const downloadStatus = document.getElementById('downloadStatus');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const shelfBtn = document.getElementById('shelfBtn');
        const shelfToggleBtn = document.getElementById('shelfToggleBtn');
        const searchTab = document.getElementById('searchTab');
        const shelfTab = document.getElementById('shelfTab');
        const historyTab = document.getElementById('historyTab');
        const shelfContent = document.getElementById('shelfContent');
        const historyContent = document.getElementById('historyContent');
        const shelfList = document.getElementById('shelfList');
        const historyList = document.getElementById('historyList');
        const exploreBooksBtn = document.getElementById('exploreBooksBtn');
        
        const helpIcon = document.getElementById('helpIcon');
        const helpModal = document.getElementById('helpModal');
        const closeBtn = document.getElementById('closeBtn');
        const overlay = document.getElementById('overlay');
        
        // 主题切换和粒子效果元素
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const particlesToggle = document.getElementById('particlesToggle');
        
        function initStorage() {
            if (!localStorage.getItem('bookShelf')) {
                localStorage.setItem('bookShelf', JSON.stringify([]));
            }
            if (!localStorage.getItem('listenHistory')) {
                localStorage.setItem('listenHistory', JSON.stringify([]));
            }
            if (!localStorage.getItem('theme')) {
                localStorage.setItem('theme', 'dark');
            }
            if (!localStorage.getItem('particlesEnabled')) {
                localStorage.setItem('particlesEnabled', 'true');
            }
        }
        
        function getBookShelf() {
            return JSON.parse(localStorage.getItem('bookShelf')) || [];
        }
        
        function addToShelf(book) {
            const shelf = getBookShelf();
            if (!shelf.some(b => b.book_id === book.book_id)) {
                shelf.push(book);
                localStorage.setItem('bookShelf', JSON.stringify(shelf));
                showSuccess('已添加到书架');
                updateShelfToggleBtn();
                return true;
            }
            return false;
        }
        
        function removeFromShelf(bookId) {
            const shelf = getBookShelf();
            const newShelf = shelf.filter(b => b.book_id !== bookId);
            localStorage.setItem('bookShelf', JSON.stringify(newShelf));
            showSuccess('已从书架移除');
            updateShelfToggleBtn();
            return true;
        }
        
        function isInShelf(bookId) {
            const shelf = getBookShelf();
            return shelf.some(b => b.book_id === bookId);
        }
        
        function getListenHistory() {
            return JSON.parse(localStorage.getItem('listenHistory')) || [];
        }
        
        function addToHistory(book, chapterIndex) {
            const history = getListenHistory();
            const existingIndex = history.findIndex(item => item.book.book_id === book.book_id);
            
            if (existingIndex !== -1) {
                history.splice(existingIndex, 1);
            }
            
            history.unshift({
                book,
                chapterIndex,
                timestamp: Date.now()
            });
            
            if (history.length > 50) {
                history.pop();
            }
            
            localStorage.setItem('listenHistory', JSON.stringify(history));
        }
        
        function updateShelfToggleBtn() {
            if (!currentBook) return;
            
            const icon = shelfToggleBtn.querySelector('i');
            if (isInShelf(currentBook.book_id)) {
                icon.classList.remove('far');
                icon.classList.add('fas');
                shelfToggleBtn.title = "从书架移除";
            } else {
                icon.classList.remove('fas');
                icon.classList.add('far');
                shelfToggleBtn.title = "加入书架";
            }
        }
        
        function displayShelf() {
            const shelf = getBookShelf();
            if (shelf.length === 0) {
                shelfList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon"><i class="fas fa-book-open"></i></div>
                        <div class="empty-text">书架空空如也</div>
                        <button class="page-btn" id="exploreBooksBtn">去发现好书</button>
                    </div>
                `;
                document.getElementById('exploreBooksBtn').addEventListener('click', () => {
                    searchTab.click();
                    searchInput.focus();
                });
                return;
            }
            
            shelfList.innerHTML = '';
            const shelfContainer = document.createElement('div');
            shelfContainer.className = 'shelf-list';
            
            shelf.forEach(book => {
                const shelfItem = document.createElement('div');
                shelfItem.className = 'shelf-item';
                shelfItem.innerHTML = `
                    <img src="${book.cover}" alt="${book.title}" class="book-cover" onerror="this.src='https://via.placeholder.com/70x90/1e1e1e/cccccc?text=No+Cover'">
                    <div class="book-info">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">${book.author || '未知作者'}</div>
                    </div>
                    <div class="book-actions">
                        <button class="book-action-btn remove-btn" title="移除">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                shelfItem.addEventListener('click', (e) => {
                    if (!e.target.closest('.book-actions')) {
                        fetchChapters(book);
                        searchTab.click();
                    }
                });
                
                const removeBtn = shelfItem.querySelector('.remove-btn');
                removeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    removeFromShelf(book.book_id);
                    displayShelf();
                });
                
                shelfContainer.appendChild(shelfItem);
            });
            
            shelfList.appendChild(shelfContainer);
        }
        
        function displayHistory() {
            const history = getListenHistory();
            if (history.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon"><i class="fas fa-clock"></i></div>
                        <div class="empty-text">暂无收听历史</div>
                    </div>
                `;
                return;
            }
            
            historyList.innerHTML = '';
            const historyContainer = document.createElement('div');
            historyContainer.className = 'shelf-list';
            
            history.forEach(item => {
                const { book, chapterIndex, timestamp } = item;
                const date = new Date(timestamp);
                const timeString = date.toLocaleString();
                
                const historyItem = document.createElement('div');
                historyItem.className = 'shelf-item';
                historyItem.innerHTML = `
                    <img src="${book.cover}" alt="${book.title}" class="book-cover" onerror="this.src='https://via.placeholder.com/70x90/1e1e1e/cccccc?text=No+Cover'">
                    <div class="book-info">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">${book.author || '未知作者'}</div>
                        <div class="book-intro">听到: ${currentChapters[chapterIndex]?.title || '未知章节'}</div>
                    </div>
                    <div class="book-actions">
                        <button class="book-action-btn" title="继续播放">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                `;
                
                historyItem.addEventListener('click', () => {
                    fetchChapters(book);
                    searchTab.click();
                });
                
                const playBtn = historyItem.querySelector('.book-action-btn');
                playBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    fetchChapters(book, chapterIndex);
                    searchTab.click();
                });
                
                historyContainer.appendChild(historyItem);
            });
            
            historyList.appendChild(historyContainer);
        }
        
        function throttleRequest() {
            const now = Date.now();
            if (now - lastRequestTime < REQUEST_INTERVAL) {
                return false;
            }
            lastRequestTime = now;
            return true;
        }
        
        // 主题切换功能
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            if (currentTheme === 'light') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'light');
            }
            updateParticlesColor();
        }
        
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            themeIcon.className = savedTheme === 'light' ? 'fas fa-sun' : 'fas fa-moon';
        }
        
        // 粒子效果功能
        function initParticles() {
            const particlesEnabled = localStorage.getItem('particlesEnabled') !== 'false';
            
            if (particlesEnabled) {
                particlesJS('particles-js', {
                    particles: {
                        number: {
                            value: 80,
                            density: {
                                enable: true,
                                value_area: 800
                            }
                        },
                        color: {
                            value: getParticlesColor()
                        },
                        shape: {
                            type: 'circle',
                            stroke: {
                                width: 0,
                                color: '#000000'
                            }
                        },
                        opacity: {
                            value: 0.5,
                            random: true,
                            anim: {
                                enable: true,
                                speed: 1,
                                opacity_min: 0.1,
                                sync: false
                            }
                        },
                        size: {
                            value: 3,
                            random: true,
                            anim: {
                                enable: true,
                                speed: 2,
                                size_min: 0.1,
                                sync: false
                            }
                        },
                        line_linked: {
                            enable: true,
                            distance: 150,
                            color: getParticlesColor(),
                            opacity: 0.4,
                            width: 1
                        },
                        move: {
                            enable: true,
                            speed: 1,
                            direction: 'none',
                            random: true,
                            straight: false,
                            out_mode: 'out',
                            bounce: false,
                            attract: {
                                enable: false,
                                rotateX: 600,
                                rotateY: 1200
                            }
                        }
                    },
                    interactivity: {
                        detect_on: 'canvas',
                        events: {
                            onhover: {
                                enable: true,
                                mode: 'grab'
                            },
                            onclick: {
                                enable: true,
                                mode: 'push'
                            },
                            resize: true
                        },
                        modes: {
                            grab: {
                                distance: 140,
                                line_linked: {
                                    opacity: 1
                                }
                            },
                            push: {
                                particles_nb: 4
                            }
                        }
                    },
                    retina_detect: true
                });
            } else {
                document.getElementById('particles-js').innerHTML = '';
            }
        }
        
        function getParticlesColor() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            return currentTheme === 'light' ? '#333333' : '#ffffff';
        }
        
        function updateParticlesColor() {
            if (particlesJS) {
                particlesJS('particles-js', {
                    particles: {
                        color: {
                            value: getParticlesColor()
                        },
                        line_linked: {
                            color: getParticlesColor()
                        }
                    }
                });
            }
        }
        
        function toggleParticles() {
            const particlesEnabled = localStorage.getItem('particlesEnabled') !== 'false';
            localStorage.setItem('particlesEnabled', !particlesEnabled);
            
            if (!particlesEnabled) {
                initParticles();
            } else {
                document.getElementById('particles-js').innerHTML = '';
            }
        }
        
        // 事件监听
        searchBtn.addEventListener('click', searchBooks);
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchBooks();
            }
        });
        
        backBtn.addEventListener('click', goBack);
        shelfBtn.addEventListener('click', toggleShelf);
        shelfToggleBtn.addEventListener('click', toggleBookInShelf);
        batchDownloadBtn.addEventListener('click', startBatchDownload);
        prevBtn.addEventListener('click', playPreviousChapter);
        nextBtn.addEventListener('click', playNextChapter);
        audioPlayer.addEventListener('ended', handleAudioEnded);
        audioPlayer.addEventListener('timeupdate', savePlaybackPosition);
        
        // 主题和粒子效果事件
        themeToggle.addEventListener('click', toggleTheme);
        particlesToggle.addEventListener('click', toggleParticles);
        
        // 标签切换
        searchTab.addEventListener('click', () => switchTab('search'));
        shelfTab.addEventListener('click', () => switchTab('shelf'));
        historyTab.addEventListener('click', () => switchTab('history'));
        
        // 帮助系统事件
        helpIcon.addEventListener('click', function() {
            helpModal.style.display = 'block';
            overlay.style.display = 'block';
        });
        
        closeBtn.addEventListener('click', function() {
            helpModal.style.display = 'none';
            overlay.style.display = 'none';
        });
        
        overlay.addEventListener('click', function() {
            helpModal.style.display = 'none';
            overlay.style.display = 'none';
        });
        
        // 切换标签
        function switchTab(tab) {
            searchTab.classList.remove('active');
            shelfTab.classList.remove('active');
            historyTab.classList.remove('active');
            searchResults.classList.remove('active');
            shelfContent.classList.remove('active');
            historyContent.classList.remove('active');
            
            switch(tab) {
                case 'search':
                    searchTab.classList.add('active');
                    searchResults.classList.add('active');
                    break;
                case 'shelf':
                    shelfTab.classList.add('active');
                    shelfContent.classList.add('active');
                    displayShelf();
                    break;
                case 'history':
                    historyTab.classList.add('active');
                    historyContent.classList.add('active');
                    displayHistory();
                    break;
            }
        }
        
        // 切换书架显示
        function toggleShelf() {
            if (shelfTab.classList.contains('active')) {
                searchTab.click();
            } else {
                shelfTab.click();
            }
        }
        
        // 切换书籍在书架中的状态
        function toggleBookInShelf() {
            if (!currentBook) return;
            
            if (isInShelf(currentBook.book_id)) {
                removeFromShelf(currentBook.book_id);
            } else {
                addToShelf(currentBook);
            }
        }
        
        // 搜索书籍
        function searchBooks() {
            if (!throttleRequest()) {
                showError('请求太快了，请稍后再试！');
                return;
            }
            
            const query = searchInput.value.trim();
            if (!query) return;
            
            currentPage = 1;
            fetchBooks(query, currentPage);
        }
        
        // 获取书籍列表
        function fetchBooks(query, page) {
            showLoading(searchResults);
            
            const url = `${API_BASE}?key=${API_KEY}&name=${encodeURIComponent(query)}&page=${page}`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.code === 200 && data.data && data.data.length > 0) {
                        displayBooks(data.data);
                        totalPages = Math.ceil(data.data.length / 10);
                        showPageControls(data.data.length > 10);
                    } else {
                        showError(data.msg || '没有找到相关书籍');
                    }
                })
                .catch(error => {
                    console.error('搜索失败:', error);
                    showError('搜索失败，请重试');
                });
        }
        
        // 显示书籍列表
        function displayBooks(books) {
            searchResults.innerHTML = '';
            
            if (books.length === 0) {
                showError('没有找到相关书籍');
                return;
            }
            
            const bookList = document.createElement('div');
            bookList.className = 'book-list';
            
            books.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = 'book-item';
                bookItem.innerHTML = `
                    <img src="${book.cover}" alt="${book.title}" class="book-cover" onerror="this.src='https://via.placeholder.com/70x90/1e1e1e/cccccc?text=No+Cover'">
                    <div class="book-info">
                        <div class="book-title">${book.title}</div>
                        <div class="book-author">${book.author || '未知作者'}</div>
                        <div class="book-intro">${book.intro || '暂无简介'}</div>
                    </div>
                    <div class="book-actions">
                        <button class="book-action-btn shelf-btn" title="${isInShelf(book.book_id) ? '从书架移除' : '加入书架'}">
                            <i class="${isInShelf(book.book_id) ? 'fas' : 'far'} fa-bookmark"></i>
                        </button>
                    </div>
                `;
                
                bookItem.addEventListener('click', () => fetchChapters(book));
                
                const shelfBtn = bookItem.querySelector('.shelf-btn');
                shelfBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (isInShelf(book.book_id)) {
                        removeFromShelf(book.book_id);
                        shelfBtn.innerHTML = '<i class="far fa-bookmark"></i>';
                        shelfBtn.title = '加入书架';
                    } else {
                        addToShelf(book);
                        shelfBtn.innerHTML = '<i class="fas fa-bookmark"></i>';
                        shelfBtn.title = '从书架移除';
                    }
                });
                
                bookList.appendChild(bookItem);
            });
            
            searchResults.appendChild(bookList);
        }
        
        // 获取章节列表
        function fetchChapters(book, playIndex = -1) {
            if (!throttleRequest()) {
                showError('请求过于频繁，请稍后再试', chapterList);
                return;
            }
            
            showLoading(chapterList);
            currentBook = book;
            selectedChapters.clear();
            
            const url = `${API_BASE}?key=${API_KEY}&book_id=${book.book_id}`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.code === 200 && data.data && data.data.length > 0) {
                        currentChapters = data.data;
                        displayChapters();
                        
                        bookTitle.textContent = book.title;
                        bookDetails.classList.remove('hidden');
                        searchResults.classList.add('hidden');
                        shelfContent.classList.add('hidden');
                        historyContent.classList.add('hidden');
                        batchDownloadPanel.classList.remove('hidden');
                        
                        pageTitle.textContent = book.title;
                        backBtn.classList.remove('hidden');
                        shelfBtn.classList.remove('hidden');
                        
                        updateShelfToggleBtn();
                        
                        if (playIndex !== -1 && playIndex < currentChapters.length) {
                            playChapter(playIndex);
                        }
                    } else {
                        showError(data.msg || '获取章节列表失败', chapterList);
                    }
                })
                .catch(error => {
                    console.error('获取章节失败:', error);
                    showError('获取章节失败，请重试', chapterList);
                });
        }
        
        // 显示章节列表
        function displayChapters() {
            chapterList.innerHTML = '';
            
            currentChapters.forEach((chapter, index) => {
                const chapterItem = document.createElement('div');
                chapterItem.className = 'chapter-item';
                if (index === currentAudioIndex) {
                    chapterItem.classList.add('now-playing');
                }
                
                const isSelected = selectedChapters.has(index);
                
                chapterItem.innerHTML = `
                    <div class="chapter-title">
                        <input type="checkbox" id="chapter-${index}" ${isSelected ? 'checked' : ''} class="hidden">
                        <label for="chapter-${index}" class="select-checkbox"></label>
                        ${chapter.title}
                        <span class="chapter-progress" id="chapterProgress-${index}"></span>
                    </div>
                    <div class="chapter-actions">
                        <button class="chapter-action-btn download-btn" title="下载">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                `;
                
                chapterItem.addEventListener('click', (e) => {
                    if (!e.target.closest('.chapter-actions') && !e.target.closest('input[type="checkbox"]')) {
                        playChapter(index);
                    }
                });
                
                const checkbox = chapterItem.querySelector('input[type="checkbox"]');
                checkbox.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        selectedChapters.add(index);
                    } else {
                        selectedChapters.delete(index);
                    }
                    updateBatchDownloadButton();
                });
                
                const downloadBtn = chapterItem.querySelector('.download-btn');
                downloadBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    downloadChapter(index);
                });
                
                chapterList.appendChild(chapterItem);
            });
            
            updateBatchDownloadButton();
            updateChapterNavButtons();
        }
        
        function updateBatchDownloadButton() {
            batchDownloadBtn.disabled = selectedChapters.size === 0;
        }
        
        function updateChapterNavButtons() {
            prevBtn.disabled = currentAudioIndex <= 0;
            nextBtn.disabled = currentAudioIndex >= currentChapters.length - 1;
        }
        
        // 播放章节
        function playChapter(index) {
            if (!throttleRequest()) {
                showError('请求过于频繁，请稍后再试');
                return;
            }
            
            const chapter = currentChapters[index];
            currentAudioIndex = index;
            
            showLoading(chapterList);
            
            const url = `${API_BASE}?key=${API_KEY}&video_id=${chapter.video_id}`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.code === 200 && data.data && data.data.url) {
                        highlightPlayingChapter();
                        
                        playerContainer.classList.remove('hidden');
                        playerInfo.textContent = `${currentBook.title} - ${chapter.title}`;
                        
                        audioPlayer.src = data.data.url;
                        audioPlayer.load();
                        
                        restorePlaybackPosition();
                        
                        audioPlayer.play().catch(e => {
                            console.log('自动播放被阻止，用户需要手动点击播放');
                        });
                        
                        updateChapterNavButtons();
                        
                        displayChapters();
                        
                        addToHistory(currentBook, currentAudioIndex);
                    } else {
                        showError(data.msg || '获取播放链接失败');
                        displayChapters();
                    }
                })
                .catch(error => {
                    console.error('获取播放链接失败:', error);
                    showError('获取播放链接失败，请重试');
                    displayChapters();
                });
        }
        
        // 保存播放位置
        function savePlaybackPosition() {
            if (!currentBook || currentAudioIndex === -1) return;
            
            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            if (isNaN(progress)) return;
            
            const progressElement = document.getElementById(`chapterProgress-${currentAudioIndex}`);
            if (progressElement) {
                progressElement.textContent = ` ${Math.round(progress)}%`;
            }
            
            const history = getListenHistory();
            const itemIndex = history.findIndex(item => item.book.book_id === currentBook.book_id);
            
            if (itemIndex !== -1) {
                history[itemIndex].progress = progress;
                localStorage.setItem('listenHistory', JSON.stringify(history));
            }
        }
        
        // 恢复播放位置
        function restorePlaybackPosition() {
            if (!currentBook || currentAudioIndex === -1) return;
            
            const history = getListenHistory();
            const item = history.find(item => 
                item.book.book_id === currentBook.book_id && 
                item.chapterIndex === currentAudioIndex
            );
            
            if (item && item.progress) {
                const seekTime = (item.progress / 100) * audioPlayer.duration;
                if (!isNaN(seekTime) && isFinite(seekTime)) {
                    audioPlayer.currentTime = seekTime;
                }
            }
        }
        
        // 播放上一章
        function playPreviousChapter() {
            if (currentAudioIndex > 0) {
                playChapter(currentAudioIndex - 1);
            }
        }
        
        // 播放下一章
        function playNextChapter() {
            if (currentAudioIndex < currentChapters.length - 1) {
                playChapter(currentAudioIndex + 1);
            }
        }
        
        // 处理音频播放结束
        function handleAudioEnded() {
            if (currentAudioIndex < currentChapters.length - 1) {
                setTimeout(() => {
                    playChapter(currentAudioIndex + 1);
                }, 500);
            }
        }
        
        // 下载单个章节
        function downloadChapter(index) {
            if (!throttleRequest()) {
                showError('请求过于频繁，请稍后再试');
                return;
            }
            
            const chapter = currentChapters[index];
            showLoading(chapterList);
            
            const url = `${API_BASE}?key=${API_KEY}&video_id=${chapter.video_id}`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.code === 200 && data.data && data.data.url) {
                        const a = document.createElement('a');
                        a.href = data.data.url;
                        a.download = `${currentBook.title}_${chapter.title}.mp3`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        
                        displayChapters();
                    } else {
                        showError(data.msg || '获取下载链接失败');
                        displayChapters();
                    }
                })
                .catch(error => {
                    console.error('获取下载链接失败:', error);
                    showError('获取下载链接失败，请重试');
                    displayChapters();
                });
        }
        
        // 批量下载选中章节
        function startBatchDownload() {
            if (selectedChapters.size === 0) return;
            
            batchDownloadBtn.disabled = true;
            downloadStatus.textContent = '准备下载...';
            downloadProgressBar.style.width = '0%';
            
            const chaptersToDownload = Array.from(selectedChapters);
            const total = chaptersToDownload.length;
            let downloaded = 0;
            
            const MAX_CONCURRENT = 1;
            let currentConcurrent = 0;
            
            function downloadNext() {
                if (downloaded >= total || currentConcurrent >= MAX_CONCURRENT) return;
                
                const index = chaptersToDownload[downloaded];
                const chapter = currentChapters[index];
                currentConcurrent++;
                
                downloadStatus.textContent = `正在下载: ${chapter.title} (${downloaded+1}/${total})`;
                
                const url = `${API_BASE}?key=${API_KEY}&video_id=${chapter.video_id}`;
                
                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        if (data.code === 200 && data.data && data.data.url) {
                            const a = document.createElement('a');
                            a.href = data.data.url;
                            a.download = `${currentBook.title}_${chapter.title}.mp3`;
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            
                            downloaded++;
                            currentConcurrent--;
                            downloadProgressBar.style.width = `${(downloaded / total) * 100}%`;
                            
                            if (downloaded < total) {
                                setTimeout(downloadNext, REQUEST_INTERVAL);
                            } else {
                                downloadStatus.textContent = `下载完成 (${downloaded}/${total})`;
                                batchDownloadBtn.disabled = false;
                            }
                            
                            downloadNext();
                        } else {
                            currentConcurrent--;
                            downloadStatus.textContent = `下载失败: ${chapter.title}`;
                            setTimeout(downloadNext, REQUEST_INTERVAL);
                        }
                    })
                    .catch(error => {
                        console.error('下载失败:', error);
                        currentConcurrent--;
                        downloadStatus.textContent = `下载失败: ${chapter.title}`;
                        setTimeout(downloadNext, REQUEST_INTERVAL);
                    });
            }
            
            for (let i = 0; i < Math.min(MAX_CONCURRENT, total); i++) {
                setTimeout(downloadNext, i * REQUEST_INTERVAL);
            }
        }
        
        // 返回上一页
        function goBack() {
            if (!bookDetails.classList.contains('hidden')) {
                bookDetails.classList.add('hidden');
                searchResults.classList.remove('hidden');
                shelfContent.classList.add('hidden');
                historyContent.classList.add('hidden');
                pageTitle.textContent = 'Mango听书';
                backBtn.classList.add('hidden');
                shelfBtn.classList.add('hidden');
                playerContainer.classList.add('hidden');
            }
        }
        
        // 显示加载中
        function showLoading(container) {
            container.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>加载中...</div>
                </div>
            `;
        }
        
        // 显示错误信息
        function showError(message, container = searchResults) {
            container.innerHTML = `
                <div class="error-message">
                    <i class="fas fa-exclamation-circle"></i> ${message}
                </div>
            `;
        }
        
        // 显示成功信息
        function showSuccess(message) {
            const container = bookDetails.classList.contains('hidden') ? searchResults : chapterList;
            const existingMessage = container.querySelector('.success-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            const messageElement = document.createElement('div');
            messageElement.className = 'success-message';
            messageElement.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            
            if (container.firstChild) {
                container.insertBefore(messageElement, container.firstChild);
            } else {
                container.appendChild(messageElement);
            }
            
            setTimeout(() => {
                messageElement.style.opacity = '1';
                setTimeout(() => {
                    messageElement.style.opacity = '0';
                    setTimeout(() => {
                        messageElement.remove();
                    }, 300);
                }, 2000);
            }, 10);
        }
        
        // 高亮当前播放章节
        function highlightPlayingChapter() {
            const chapters = chapterList.querySelectorAll('.chapter-item');
            chapters.forEach((item, index) => {
                if (index === currentAudioIndex) {
                    item.classList.add('now-playing');
                    item.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    item.classList.remove('now-playing');
                }
            });
        }
        
        // 显示分页控件
        function showPageControls(show) {
            const existingControls = searchResults.querySelector('.page-controls');
            if (existingControls) {
                existingControls.remove();
            }
            
            if (show) {
                const controls = document.createElement('div');
                controls.className = 'page-controls';
                controls.innerHTML = `
                    <button class="page-btn" id="prevPage" ${currentPage <= 1 ? 'disabled' : ''}>
                        <i class="fas fa-chevron-left"></i> 上一页
                    </button>
                    <span class="current-page">${currentPage}/${totalPages}</span>
                    <button class="page-btn" id="nextPage" ${currentPage >= totalPages ? 'disabled' : ''}>
                        下一页 <i class="fas fa-chevron-right"></i>
                    </button>
                `;
                
                controls.querySelector('#prevPage').addEventListener('click', () => {
                    if (currentPage > 1) {
                        currentPage--;
                        fetchBooks(searchInput.value.trim(), currentPage);
                    }
                });
                
                controls.querySelector('#nextPage').addEventListener('click', () => {
                    if (currentPage < totalPages) {
                        currentPage++;
                        fetchBooks(searchInput.value.trim(), currentPage);
                    }
                });
                
                searchResults.appendChild(controls);
            }
        }
        
        // 初始化
        function init() {
            initStorage();
            loadTheme();
            initParticles();
            displayShelf();
            displayHistory();
        }
        
        init();
    </script>
</body>
</html>
